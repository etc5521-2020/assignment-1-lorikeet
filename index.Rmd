---
title: "ETC5521 Assignment 1"
subtitle: "Measles Vaccination"
team: Lorikeet
author:
  - Aryan Jain
  - Emily Sheehan
  - Jimmy Effendy
  - DIYAO CHEN
date: "`r Sys.Date()`"
output: 
  bookdown::html_document2
---

[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}

```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      message = FALSE, 
                      warning = FALSE)
```

```{r libraries}
# Load libraries
library(tidyverse)
library(scales)
library(ggrepel)
library(knitr)
library(kableExtra)
library(naniar)
library(ggplot2)
library(mapview)
library(sf)
library(maps)
library(tools)
library(ggpubr)
library(plotly)
library(here)
library(patchwork)
library(ggExtra)
library(ggridges)
library(viridis)
library(cowplot)
library(colorspace)
library(janitor)
```

```{r load-data}
# Read in data from github
#measles <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-02-25/measles.csv')

#state_income <- readr::read_csv('https://raw.githubusercontent.com/TaxFoundation/facts-and-figures/master/42-income-per-capita-by-state.csv') %>%
  #filter(id != 0)

#Read in data from repo
measles <- read_csv(here::here("data/measles.csv"))
state_income <- read_csv(here::here("data/state_income.csv"))
educational_attainment <- read_csv(here::here("data/educational_attainment.csv"))
migration <- read_csv(here::here("data/migration.csv"))
```


# Introduction and Motivation

Measles is a highly infectious disease caused by the Measles virus. It can lead to pneumonia, infections of the middle ear, swelling of the brain and death.

A vaccine exists to prevent the onset of measles as there is no treatment. The vaccine involves the injection of attenuated measles antigens that stimulate the production of antibodies and memory cells, providing long-term protection against the virus. When administered properly, the vaccine is 90.5% effective within 72 hours of exposure (Barrabeig et al., 2011).

Unfortunately there is a growing number of individuals refusing vaccination, particularly in the US (Phadke et al., 2016). In Texas, the number of unvaccinated children attaining exemptions to attend school has increased by 28 times since 2003 (Sinclair et al., 2019). This has led to several outbreaks of vaccine preventable diseases, such as Measles. If this trend continues, there could be calamitous consequences. 

This paper hopes to determine whether there is a relationship between socioeconomic status and MMR vaccination rate. Specifically, it explores how MMR vaccination rates fluctuate across different school types, states, income levels, enrollment numbers, educational attainment level, and proportion of foregin born populations. It will also compare the MMR vaccination rates against the overall vaccination rates.

Specifically, this paper hopes to answer the following questions:

- **Primary Question**: 

  + Does Measles vaccination rate improve with better socioeconomic conditions?

- **Secondary Questions**:

  + Are the MMR vaccination rates higher in private schools?
  + How does school's MMR Vaccination rate compare to the school's overall vaccination rate?
  + Which states have the lowest vaccination rates?
  + Does higher income per capita lead to higher MMR vaccination rates?
  + Are MMR vaccination rates lower in areas with higher proportion of foreign-born population? 
  + Does regions with better educational attainments have higher MMR vaccination rates?

First, the paper will discuss the data used and how it is prepared for the analysis. Then, analysis and findings about the research questions will be presented and discussed.

# Data Description

```{r find-missing-data, fig.cap="Missingness of the WSJ Measles Dataset", include=FALSE}
# Analyse how many variables are missing
naniar::vis_miss(measles, warn_large_data = FALSE)
```

To analyse the relationship a dataset was retrieved from Wall Street Journal (WSJ). The data comprises of vaccination rates for 46,412 schools in 32 U.S states and was retrieved from The Wall Street Journal. The variables include; the school academic year, the school's state, city, county, district, name, type, enrollment, MMR (measles, mumps and rubella) vaccination rate, overall vaccination rate, latitude, longitude and the percentage of students exempted from vaccinations due to personal, religious or medical reasons. The state health departments provided the vaccination data and the National Center for Education Statistic's provided the school location, which was matched against the school name. In the case that there was no match, the school's location was found with Google Maps API.

Additional data from the U.S. Census Bureau is also retrieved for 2018 county level income per capita, educational attainment level, and the number of foreign-born population. This was done by utilizing Census data API provided by the Census Bureau as well as with tidycensus package.

## Data Limitation

One of the limitation of the WSJ measles data is that there is inconsistencies in data collection methods. The data was collected in the 2017-18 school year for 11 states, but for the remaining 21 states, it was collected in 2018-19 school year. Moreover, with the help of naniar package, it can be easily identified that this dataset has a considerable amount of missing values. Although every precaution has been taken to ensure accurate figures have been calculated, some of the MMR rates, overall vaccination rates and school types were missing from the original dataset. The following variables are largely unusable as due to its high number of missing values:

- `xrel`: the percentage of students exempted from vaccinations due to personal reasons
- `xmed`: the percentage of students exempted from vaccinations due to medical reasons
- `xper`: the percentage of students exempted from vaccinations due to religious reasons
- `district`: school district

## Data Cleaning and Transformation

The individual state dataset was scraped from the Tidy Tuesday Github repository and combined with the existing measles dataset with *left_join* to extract the longitude and latitude variables from it. Various functions from the *rvest* package were used to scrape the data including *read_html* and *html_table*.

A considerable amount of data wrangling needed to be done for the U.S. census dataset as they do not provide descriptions of what each variable represents (e.g. variable B19301_001 represents Income Per Capita). In addition variable `county_state`, comprising of county and state, needed to be added for the measle and U.S. census dataset. This variable is used as a key to merge the measles and U.S. census dataset. This is achieved by utilizing `tidyverse` and `janitor` packages.

```{r data-wrangling}
measles <- measles %>% 
  mutate(county_state = str_c(county, ", ", state))

measles_type <- measles %>%
  # remove missing data
  filter(type != "NA",
         mmr != -1)
```

# Analysis and Findings

## Are the MMR Vaccination Rates Higher in Private Schools?

The measles data was filtered to remove missing school type, overall vaccination rate and MMR rate. It was grouped by type of school and the average MMR vaccination rate and overall vaccination rate was calculated using the _mean_ function. The tibble generated was named _school_type_average_. Then, the average MMR rates from the  _school_type_average_ tibble were plotted. The rates were annotated accordingly, to draw attention to the difference between the MMR vaccination rate for each school type. 

```{r school-type-average}
school_type_average <- measles_type %>%
  # group by type of school
  group_by(type) %>%
  # calculate the average mmr rate l
  summarise(average_mmr_rate = mean(mmr))

school_type_average %>%
  # convert rates to a percentage
  mutate(average_mmr_rate = round(average_mmr_rate,2)) %>%
  arrange(desc(average_mmr_rate)) %>% 
  # change column names
  kable(col.names = c("Type",
                      "Average MMR Vaccination Rate (%)"),
        # add a caption
        caption = "Comparison of MMR Average Vaccination Rates according to School Type",
        align = c("l","r")) %>%
  kable_styling()
```

```{r school-type-plot, fig.cap="Box plot of School's MMR Vaccination Rates by School Types"}
mmr_mean <- round(mean(measles_type$mmr))

measles_type %>% 
  ggplot(aes(x = mmr,
             y = reorder(as.factor(type), mmr))) +
  geom_boxplot(fill = "darkcyan",
               alpha = 0.2)+
  labs(subtitle = "The mean of school's MMR vaccination rate is shown by the red line") +
  xlab("MMR vaccination Rate") +
  ylab("Type of School") +
  ggtitle("The School's MMR Vaccination Rate") +
  geom_vline(xintercept = mmr_mean, color = "red") +
  scale_x_continuous(breaks = c(0, 25, 50, 75, 95, 100)) +
  theme_bw()
```

The MMR vaccination rate was the highest in public schools, as seen in the table above. This is consistent with findings from a study conducted by Shaw (2014) where it was found that private schools have higher rates of exemptions for immunisations than public schools.


## How Does School's MMR Vaccination Rate Compare to the School's Overall Vaccination Rate?

```{r vacc-diff}
measles_diff <-  measles %>%
  # remove missing data
  filter(type != "NA",
         mmr != -1,
         overall != -1) %>% 
  mutate(rdiff = mmr - overall)

school_vs_overall <- measles_diff %>%
  # group by type of school
  group_by(type) %>%
  # calculate the average mmr rate and overall rate according to type of school
  summarise(school_mmr_rate = mean(mmr),
            school_overall_rate = mean(overall),
            rate_diff = mean(rdiff)) 


school_vs_overall %>%
  # convert rates to a percentage
  mutate(school_mmr_rate = round(school_mmr_rate,2),
         school_overall_rate = round(school_overall_rate,2),
         rate_diff = round(rate_diff,2)) %>%
  kable(col.names = c("School Type",
                      "School MMR Vaccination Rate (%)",
                      "School Overall Vaccination Rate (%)",
                      "Rate Differences (%)"),
        # add a caption
        caption = "School's MMR Vaccination Rate and Overall Vaccination Rate Comparison") %>%
  kable_styling()
```

```{r vac-diff-plot}
measles_diff %>% 
  ggplot(aes(x = type,
             y = rdiff)) +
  geom_violin(fill = "darkcyan", 
              alpha = 0.2) +
  geom_boxplot(width = 0.02, 
               fill = "darkorange", 
               alpha = 0.5) +
  scale_y_continuous() +
  ylim(0,20) +
  theme_bw()
```

The _school_type_average_ data was tabulated to compare the overall vaccination rate and MMR vaccination rate. Then, both rates were plotted according to school type. 

When comparing the vaccination rates according to school type, it is clear that the overall vaccination rate is lower than the MMR vaccination rate for all school types as seen in the plot below. Public schools have the highest overall vaccination rate and MMR rate. 


## Which states have lowest vaccination rates?

The measles data was grouped by state and then the average MMR and overall vaccination rate were calculated. Then, the _map_data_ function was used to create a tibble containing the geographical information of each state. This data was merged with the _measles_states_ data, which contains the average MMR and overall vaccination rate for each state. Any missing data or negative values were removed and the remaining data was plotted onto a map and bar chart using _geom_polygon_ and _geom_col_, respectively. The _ggplotly_ function was used to make the maps interactive. 


```{r density-summary}
# Measles vaccination across all American states and school count
measles_density_90 <- measles %>%
  filter(mmr < 90,
         mmr != -1) %>% 
  group_by(state) %>%
  summarise(mmr = mean(mmr),
            overall = mean(overall),
            count = n())

# Measles vaccination across state
measles_states_90 <- measles_density_90[c("state", 
                                    "mmr", 
                                    "overall")] %>%
  rename(region = state) %>%
  mutate(region = tolower(region))
```

```{r map-data}
# Use map_data() to create usa mapping dataframe
usa <- map_data("state")

# Merging usa map data with measles across state data
usa_measles_states <- merge(usa, 
                            measles_states_90, 
                            all.x = TRUE)

# finding centroids and abb of each state
states <- st_as_sf(map("state", 
                       plot = FALSE, 
                       fill = TRUE))
states <- cbind(states, 
                st_coordinates(st_centroid(states)))
states$abb <- state.abb[match(states$ID,tolower(state.name))]

# Merging measles state data and usa map data with centroid data
usa_measles_states <- merge(usa_measles_states, 
                            states[c("ID", "X", "Y", "abb")], 
                            by.x = "region", 
                            by.y = "ID") %>%
  ungroup() %>%
  arrange(order)

# filter the missing data out
#usa_measles_states_overall <- usa_measles_states %>%
  #filter(overall > 0)

usa_measles_states_mmr <- usa_measles_states %>%
  filter(mmr > 0)
```

```{r mmr-map}
# MMR vaccination rate across the states
# add ggplotly to make the plot interactive
mmr_p <- ggplot(usa_measles_states_mmr, aes(long, 
                                            lat, 
                                            group=group, 
                                            fill=mmr)) +
  geom_polygon(color = "light grey") +
  geom_text(aes(X, Y, 
                label = abb), 
            size = 4,
            color = "white",
            family = "sans") +
  scale_fill_viridis() +
    # add title and x and y axis and remove the legend
  ggtitle("The Number of Schools with MMR Vaccination Rate Below 90% across States") +
  xlab("Latitude") +
  ylab("Longitude") +
  theme_bw()
  #theme(legend.position = "none"))
ggplotly(mmr_p)
```

```{r mmr-chart}
measles_density_90 %>% 
  ggplot(aes(x = mmr,
             y = reorder(state, mmr))) +
  geom_col(fill = "darkcyan") + 
  geom_vline(xintercept = mean(measles_density_90$mmr),
             color = "red")
  theme_bw()
```

The state with the highest MMR vaccination rate is Illinois at 97.39% and the state with the lowest MMR vaccination rate is Massachusetts at 57.68% as shown in the figure below. 

The state with the highest overall vaccination rate is North Caroline at 96.779%, while the state with the lowest vaccination rate is Washington at 75.238% as shown in the figure above. It is difficult to compare the individual states MMR vaccination rate with the overall vaccination rate due to the missing data. However, California, Vermont, Ohio and Oregon have similar MMR and overall vaccination rates. 

## Are MMR Vaccination Rates Lower in Lower Income Counties?

To analyse the average income of the states with the highest and lowest vaccination rate, an external dataset from [Tax Foundation:Github Repository](https://github.com/TaxFoundation/facts-and-figures) was retrieved. This data was merged with the measles data grouped by state, and the top and bottom five observations were tabulated for both the vaccination rates. The vaccination rate and income data were plotted using _geom_col_ and _gg_arrange_, and ordered in descending order. 

```{r measles-density-income}
# Measles vaccination across all American states and school count
measles_county <- measles %>%
  filter(county != "#N/A",
         mmr != -1) %>% 
  group_by(county_state) %>%
  summarise(mmr = mean(mmr),
            overall = mean(overall),
            count = n())

measles_county_income <- measles_county %>% 
  left_join(state_income,
            by = "county_state") %>% 
  rename(percapita_income = estimate) %>% 
  filter(percapita_income != "NA")

#Adding a quantile column
measles_county_income <- within(measles_county_income,
                                quartile <- as.integer(cut(percapita_income,
                                                           quantile(percapita_income,
                                                                    probs = 0:4/4),
                                                           include.lowest = TRUE)))

measles_county_income$quartile <- as.factor(measles_county_income$quartile)

measles_county_income %>% 
  ggplot(aes(x = percapita_income,
             y = mmr)) +
  geom_point(data = select(measles_county_income, -state),
             color = "gray") + 
  geom_point(aes(color = state)) +
  geom_smooth(method = lm, se = FALSE) +
  ylim(60,100) +
  facet_wrap(~state) +
  scale_color_discrete_qualitative() + 
  guides(color = FALSE) +
  theme_bw()
```

```{r best-mmr}
measles_state_income <- measles_county_income %>%
  select(state, 
         mmr, 
         percapita_income) %>%
  group_by(state) %>% 
  summarise(avg_mmr = mean(mmr),
            avg_percapita_income = mean(percapita_income))

measles_state_income %>%
  mutate(avg_mmr = round(avg_mmr,2),
         avg_percapita_income = dollar(avg_percapita_income)) %>%
  arrange(desc(avg_mmr)) %>%
  head(5) %>%
  # add a caption
  kable(caption = "The Per Capita Income of the States with the Highest MMR Vaccination Rate",
        col.names = c("States", "MMR Vaccination Rate (%)", "Per Capita Income")) %>%
  kable_styling()
```

```{r worst-mmr}
measles_state_income %>%
  # convert mmr to a percentage
  mutate(avg_mmr = round(avg_mmr,2),
         avg_percapita_income = dollar(avg_percapita_income)) %>%
  arrange(avg_mmr) %>%
  head(5) %>%
  # add a caption
  kable(caption = "The Per Capita Income of the States with the Lowest  MMR Vaccination Rate",
        col.names = c("States", "MMR Vaccination Rate (%)", "Per Capita Income")) %>%
  kable_styling()
```

The states with the highest MMR vaccination rate were; Illinois, Pennsylvania, Utah, Colorado and New York. These states each have an average per capita income of \$56,839,	\$56,225, \$46,320, \$58,456 and \$68,668, respectively, as shown in the plot below.

## What Does Enrollment Numbers Tell Us about MMR Vaccination Rates?

```{r enrollment-data}
measles_enroll <- measles %>% 
  filter(mmr != -1,
         enroll != "NA") %>%
  group_by(county, state) %>% 
  summarise(mmr = mean(mmr),
            enroll = mean(enroll)) %>% 
  filter(state != "Arkansas",
         state != "Pennsylvania")
```

```{r enrollment-distribution}
measles %>% 
  ggplot(aes(x = enroll,
             y = ..density..)) +
  geom_histogram(binwidth = 5,
                 fill = "darkcyan",
                 alpha = 0.2) +
  geom_density() +
  geom_vline(xintercept = median(measles$enroll,
                               na.rm = TRUE),
             color = "red") +
  xlim(0,1000) +
  theme_bw() 
```

```{r enrollment-table}

measles_enroll %>% 
  mutate(mmr = round(mmr,2),
         enroll = round(enroll)) %>% 
  arrange(mmr) %>% 
  head(5) %>% 
  kable(col.names = c("County", 
                      "State", 
                      "MMR Vaccination Rates (%)", 
                      "Enrollment")) %>% 
  kable_styling()
```

```{r enrollment-plot}
measles_enroll %>% 
  ggplot(aes(x = enroll,
             y = mmr)) +
  geom_point(aes(color = state)) +
  geom_smooth(method = lm, se = FALSE) +
  guides(color = FALSE) +
  facet_wrap(~state, scales = "free") +
  theme_bw()
```

## Are MMR Vaccination Rates Lower in Areas with Higher Proportion of Foreign Born Population?

```{r migration}
migration$variable_description <- as.factor(migration$variable_description)
migration$state <- as.factor(migration$state)
migration$county <- as.factor(migration$county)
migration$county_state <- as.factor(migration$county_state)

migration_wide <- migration %>% 
  select(-X1) %>% 
  pivot_wider(names_from = variable_description,
              values_from = estimate) %>% 
  clean_names() %>%
  mutate(foreign_prop = total_foreign_born/total_population)

migration_wide %>% 
  ggplot(aes(x = foreign_prop,
             y = reorder(state, foreign_prop, median))) +
  geom_boxplot() +
  theme_bw()
```

```{r migration-measles}
measles_county_migration <- measles_county %>% left_join(migration_wide,
                             by = "county_state") %>% 
  filter(foreign_prop != "NA")
```

## Education

```{r education-data}
educational_attainment$variable_description <- as.factor(educational_attainment$variable_description)
educational_attainment$state <- as.factor(educational_attainment$state)
educational_attainment$county <- as.factor(educational_attainment$county)
educational_attainment$county_state <- as.factor(educational_attainment$county_state)


measles_education <- measles_county %>% 
  left_join(educational_attainment,
            by = "county_state") %>% 
  select(-X1) %>% 
  filter(estimate != "NA")

measles_education_wide <- measles_education %>% 
  pivot_wider(names_from = variable_description,
              values_from = estimate) %>% 
  clean_names()%>%
  mutate(bachelor_prop = round(bachelor_degree/total_population*100,2),
         highschool_prop = round(high_school_graduates/total_population*100,2),
         less_highschool_prop = round(less_than_high_school_graduates/total_population*100,2))%>%
  select(state,bachelor_prop,highschool_prop,less_highschool_prop,mmr)%>%
  group_by(state)%>%
  summarise(bachelor_prop = mean(bachelor_prop),highschool_prop = mean(highschool_prop),mmr=mean(mmr))%>%
  mutate(education_level = bachelor_prop + highschool_prop)%>%
  select(state,mmr,education_level)%>%
  group_by(mmr)
measles_education_wide
```


```{r}
measles_education_wide%>%
   plot_ly(y = ~ state, 
          x = ~ mmr, 
          orientation = 'h',
          text =  ~ mmr,
          textposition = 'auto',
          type = "bar", 
          name = "mmr",
          marker = list(color = "#1f77b4")) %>%
  add_trace(x = ~ education_level,
            text =  ~ education_level,
            textposition = 'auto',
            name = "education",
            marker = list(color = "forestgreen")) 
```
# Conclusion

The analysis has revealed that it is likely that there is no association with socioeconomic status and vaccination rates. Private schools, which are more expensive than public schools thus inferring greater socioeconomic status, have a lower average MMR and average overall vaccination rate than their public counterparts. The two states with the lowest MMR vaccination rate; Connecticut and Massachusetts, had the two highest average per capita incomes. Similarly, Washington had the lowest overall vaccination rate and one of the highest average per capita incomes. Therefore, it is unlikely that vaccination rate improves with socioeconomic status. 

# References

Alboukadel Kassambara (2020). ggpubr: 'ggplot2' Based
  Publication Ready Plots. R package version 0.4.0.
  https://CRAN.R-project.org/package=ggpubr
  
Barrabeig, I., Rovira, A., Rius, C., Muñoz, P., Soldevila, N., Batalla, J., &
  Domínguez, A. (2011). Effectiveness of measles vaccination for control of exposed children. The
  Pediatric Infectious Disease Journal, 30(1), 78–80.

C. Sievert. Interactive Web-Based Data Visualization with R,
  plotly, and shiny. Chapman and Hall/CRC Florida, 2020.

Cockcroft, A., Usman, M. U., Nyamucherera, O. F., Emori, H., Duke, B., Umar, N.
  A., & Andersson, N. (2014). Why children are not vaccinated against measles: a
  cross-sectional study in two Nigerian States. Archives of Public Health = Archives Belges de Sante
  Publique, 72(1), 48.

Commonwealth of Australia. (2020, May 27). Measles. Retrieved 25 August 2020, from
  https://www.health.gov.au/health-topics/measles#what-is-measles

Hadley Wickham and Dana Seidel (2020). scales: Scale
  Functions for Visualization. R package version 1.1.1.
  https://CRAN.R-project.org/package=scales
  
H. Wickham. ggplot2: Elegant Graphics for Data Analysis.
  Springer-Verlag New York, 2016.
  
Hao Zhu (2019). kableExtra: Construct Complex Table with
  'kable' and Pipe Syntax. R package version 1.1.0.
  https://CRAN.R-project.org/package=kableExtra
  
Kamil Slowikowski (2020). ggrepel: Automatically Position
  Non-Overlapping Text Labels with 'ggplot2'. R package version
  0.8.2. https://CRAN.R-project.org/package=ggrepel
  
Mock, T. (2018). TidyTuesday–W weekly social data project in R. URL:
  https://github. com/rfordatascience/tidytuesday, 3.  

Nicholas Tierney, Di Cook, Miles McBain and Colin Fay (2020).
  naniar: Data Structures, Summaries, and Visualisations for
  Missing Data. R package version 0.5.2.
  https://CRAN.R-project.org/package=naniar  
  
Original S code by Richard A. Becker, Allan R. Wilks. R
  version by Ray Brownrigg. Enhancements by Thomas P Minka and
  Alex Deckmyn. (2018). maps: Draw Geographical Maps. R package
  version 3.3.0. https://CRAN.R-project.org/package=maps

Pebesma, E., 2018. Simple Features for R: Standardized
  Support for Spatial Vector Data. The R Journal 10 (1),
  439-446, https://doi.org/10.32614/RJ-2018-009  
  
Phadke, V. K., Bednarczyk, R. A., Salmon, D. A., & Omer, S. B. (2016). Association Between
  Vaccine Refusal and Vaccine-Preventable Diseases in the United States: A Review of Measles and
  Pertussis. JAMA: The Journal of the American Medical Association, 315(11), 1149–1158. 
  
Queensland Health. (2019, October 22). What is measles and why do we vaccinate against it?
  Retrieved 25 August 2020, from
  https://www.health.qld.gov.au/news-events/news/what-is-measles-why-vaccinate#:~:text=The%20
  easles%20vaccine%20contains%20a,is%20better%20prepared%20to%20respond
  
R Core Team (2020). R: A language and environment for
  statistical computing. R Foundation for Statistical
  Computing, Vienna, Austria. URL https://www.R-project.org/.
  
Sinclair, D. R., Grefenstette, J. J., Krauland, M. G., Galloway, D. D., Frankeny, R. J.,
  Travis, C., … Roberts, M. S. (2019). Forecasted Size of Measles Outbreaks Associated With
  Vaccination Exemptions for Schoolchildren. JAMA Network Open, 2(8), e199768.

Shaw, J., Tserenpuntsag, B., McNutt, L.-A., & Halsey, N. (2014). United States private schools
  have higher rates of exemptions to school immunization requirements than public schools. The
  Journal of Pediatrics, 165(1), 129–133.  
  
Tim Appelhans, Florian Detsch, Christoph Reudenbach and
  Stefan Woellauer (2020). mapview: Interactive Viewing of
  Spatial Data in R. R package version 2.9.0.
  https://CRAN.R-project.org/package=mapview  

VanAntwerp, T. (2016). TaxFoundation facts-and-figures. GitHub repository.
  Retrieved from https://github.com/TaxFoundation/facts-and-figures

Wickham et al., (2019). Welcome to the tidyverse. Journal of
  Open Source Software, 4(43), 1686,
  https://doi.org/10.21105/joss.01686
  
Yihui Xie (2020). knitr: A General-Purpose Package for
  Dynamic Report Generation in R. R package version 1.29.

  Yihui Xie (2015) Dynamic Documents with R and knitr. 2nd
  edition. Chapman and Hall/CRC. ISBN 978-1498716963

  Yihui Xie (2014) knitr: A Comprehensive Tool for Reproducible
  Research in R. In Victoria Stodden, Friedrich Leisch and
  Roger D. Peng, editors, Implementing Reproducible
  Computational Research. Chapman and Hall/CRC. ISBN
  978-1466561595
